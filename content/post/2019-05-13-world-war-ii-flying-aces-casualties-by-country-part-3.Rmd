---
title: World War II Flying Aces - Casualties (part 3)
author: Martin Frigaard
date: '2019-05-13'
slug: world-war-ii-flying-aces-casualties-by-country-part-3
categories:
  - R
tags:
  - wikipedia
  - tidyverse
description: ''
topics: []
---


```{r setup, echo = FALSE, include = FALSE}
library(tidyverse)
library(skimr)
library(janitor)
# create figs
# if (!file.exists("figs/")) {
#   dir.create("figs/")
# }
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = " "
  # fig.path = "figs/",
  # fig.height = 3,
  # fig.width = 5
  # fig.align = "center",
  # fig.ext = "png"
)
```


[\@mjfrigaard](https://twitter.com/mjfrigaard)

> This is part 3 of a series looking at [World War II flying aces](https://en.wikipedia.org/wiki/List_of_World_War_II_flying_aces). In part 1, I showed how to download data from a Wikipedia (html) table. Then in part 2, I showed some wrangling techniques with `dplyr` and `janitor`, and some exploratory data analysis with `inspectdf`. We discovered that Germany had the highest average number of aerial victories. In this post we will look at the casualties and survivability of flying aces in WW2.

## The previous data set

The data from the previous post have been loaded into Github [here](https://github.com/mjfrigaard/cloud-projects). This has a few additional variables that aren't in the wikipedia table, so I recommend reading the [previous post](https://www.martinfrigaard.io/post/exploring-ww2-figher-pilots/) if you haven't.

Use `readr` to import these data into RStudio.

```{r WW2FlyingAces}
WW2FlyingAces <- readr::read_csv("http://bit.ly/ww2-pilot-data")
WW2FlyingAces %>% dplyr::glimpse(78)
```

## The average number of aerial victories 

The last post ended by showing Germany had the highest average number of aerial victories among WW2 flying aces. Below is a display of the top 10 mean aerial victories (`air_vic`) by `country`.

```{r mean-aerial-victories}
  WW2FlyingAces %>%
    dplyr::group_by(country) %>%
    dplyr::summarize(`mean aerial victory` = mean(air_vic)) %>%
    dplyr::mutate(`mean aerial victory` = round(`mean aerial victory`, 2)) %>% 
    dplyr::arrange(desc(`mean aerial victory`))
```

The `mean aerial victory` for `Germany` shows 30+ victories higher than all other the countries (the `Soviet Union` was ranked 2nd at `40.29` average victories). That's a pretty wide margin. But the `mean aerial victory` might not be the best way to determine which country had air superiority, or which country had the most successful aerial warfare campaign.

While the average number of aerial victories *does* give us a picture of how good the best pilots were, it *doesn't* give us an idea of how the pilots contributed to the overall war effort or to mission success. For example, if all your best pilots are ending up `KIA`, `MIA`, or `Died of wounds`, it's not likely your country will keep winning air battles. This is analogous to a baseball team having a pitcher with an amazing strikeout record, but keeping him in the game until he blows out his arm.

It makes sense to also look at the number of pilot casualties, or even better, *the number of flying aces who survived and were able to continue fighting throughout the entire war.* Having your best pilots return from battle means more experienced pilots, who are more likely to win future engagements. 

## Flying Ace Survivability

We can use the `country` and `mia_or_kia` variables to calculate the totals and percentage of pilots who survived with the versatile `janitor::tabyl()` functions. Below are the countries with the top 10 numbers of pilots who survived. 

```{r WW2CountryXCasualties}
# create tabyl and arrange by number survived
WW2CountryXCasualties <- WW2FlyingAces %>%
  janitor::tabyl(country, mia_or_kia) %>%
  dplyr::rename(
    total_casaulty = `KIA, MIA, Died of wounds`,
    total_survived = `Lived`) %>%
  dplyr::arrange(desc(total_survived))
WW2CountryXCasualties %>% utils::head(10)
```

`WW2CountryXCasualties` shows us the `United States` and `Germany` have the highest numbers of flying aces survive (`total_survived`). But if we look at the number of flying aces who didn't return from battle (i.e. the `total_casaulty` column), we can see `Germany` also had a high number of pilots ending up in the `KIA, MIA, Died of wounds` category. 

If we arrange `WW2CountryXCasualties` on the `total_casaulty` column, we see that `Germany` is actually the highest ranked country in terms of total pilots `KIA, MIA, Died of wounds`.

```{r sort-total_casaulty}
WW2CountryXCasualties %>%
  dplyr::arrange(desc(total_casaulty)) %>%
  utils::head(10)
```

But these raw totals aren't telling us enough--we want the number of casualties in relation to the total number of flying aces. We will add the following variables to the `WW2CountryXCasualtiesRatio` data frame, 

`ratio_casaulty` = `flying aces MIA, KIA, Died of wounds` / `total flying aces` 

and 

`ratio_survived` = `flying aces survived` / `total flying aces`

These two variables will allow us to compare the number of pilots who survived against those who didn't. We can create these with the `janitor::adorn_percentages("row")` function, then rename each column with a more precise name, and convert the object to a `tibble` for better printing. 

```{r WW2CountryXCasualtiesRatio}
# add row totals to WW2CountryXCasualties
WW2CountryXCasualtiesRatio <- WW2CountryXCasualties %>%
  janitor::adorn_percentages("row") %>%
  dplyr::rename(
    ratio_casaulty = total_casaulty,
    ratio_survived = total_survived) %>%
  as_tibble()
WW2CountryXCasualtiesRatio %>% utils::head(10)
```

Now we're getting somewhere! The `WW2CountryXCasualtiesRatio` tibble is showing the percentage of pilots who survived vs. the percentage who didn't. However, it would be nice to know the *actual* numbers of pilots in each category, too. We'll join `WW2CountryXCasualties` and `WW2CountryXCasualtiesRatio` back together into `WW2CountryXCasualtiesPerc`.

```{r WW2CountryXCasualtiesPerc}
# join
WW2CountryXCasualtiesPerc <- dplyr::inner_join(
  x = WW2CountryXCasualties,
  y = WW2CountryXCasualtiesRatio,
  by = "country")
WW2CountryXCasualtiesPerc %>% utils::head(10)
```

We should check our work to make sure the new variables make sense: 

```{r check-work}
# check us ratio to see that it sums to 1
0.01204819 + 0.9879518
```

## Plot the survivability of flying aces

The `WW2CountryXCasualtiesPerc` table will be handy for plotting another [Cleveland dot plot](https://en.wikipedia.org/wiki/Dot_plot_(statistics)#Cleveland_dot_plots) like the one from the previous post, but this time I will be able to use the ratio as a percent in the labels. 

```{r Plot-WW2CountryXCasualtiesPerc}
WW2CountryXCasualtiesPerc %>%

  # join this to the original table to get the force variable
  inner_join(x = ., y = WW2FlyingAces, by = "country") %>%

  # plot new total_survived and ratio_survived
  ggplot2::ggplot(aes(
    x = total_survived,

    # wrangle the country variable in the plot function
    y = forcats::fct_reorder(
      .f = country,
      .x = total_survived),

    # add group aesthetic here
    group = force,

    # add the scales to format the ratio_survived
    label = scales::percent(round(ratio_survived, 3)))) +

  # start this line at the country (on the y)
  ggplot2::geom_segment(aes(yend = country),

    # end at -1 on the X
    xend = -1,

    color = "grey50") +

  # add points and color by the force variable
  ggplot2::geom_point(
    size = 2.3,
    aes(color = force)) +

  # adjust size and nudge so the number is visible
  geom_text(aes(color = force),
    # adjust size
    size = 2.5,
    # nudge
    nudge_x = 38) +

  # this is for the legend on the graph
  ggplot2::scale_colour_brewer(
    palette = "Set1",
    # these are manually labelled
    limits = c("Axis", "Allied")) +

  # add this theme because it looks old-school
  ggthemes::theme_tufte(base_size = 8, ticks = 3) +

  # add labels
  ggplot2::labs(
    title = "Flying Aces Pilot Survivability in WW2",
    y = "Country/Service",
    x = "Flying aces surviving aerial victories in WW2") +

  # add theme elements
  ggplot2::theme(
    axis.text.x = element_text(
      size = 7.5,
      family = "Courier New"),
    # these look better on the axes
    axis.text.y = element_text(
      size = 7.5,
      family = "Courier New"),
    # this look better as axis titles
    axis.title.x = element_text(size = 9),
    axis.title.y = element_text(size = 9),
    axis.title = element_text(size = 10),
    # switch the text in the legend and title
    legend.text = element_text(size = 7,
      family = "Andale Mono"),
    title = element_text(family = "Andale Mono",
      size = 12))
```

The plot above shows the number of total number of flying aces who survived in each country *and* the percent. Displaying both of these measurements give us a more complete picture of pilot success and air superiority throughout the war. 

## Variations in military doctrine for pilots 

Each country had their own methods and doctrine for how their pilots were trained and what counted as an aerial victory. The Japanese pilots, for example, were known for having kamikaze pilots, and built their planes with the expectation that the pilots would stay in the battle until they died. This method was moderately successful for a few battles, but also basically guaranteed that Japan would be losing pilots faster than they could train and equip replacements. You can read more about kamikaze pilots [here](https://www.latimes.com/archives/la-xpm-2004-sep-25-fg-kamikaze25-story.html).

We can also display the data above in a table using a few additional `janitor` functions (see below):

```{r table-WW2CountryXCasualties}
WW2CountryXCasualties %>%
  janitor::adorn_percentages("row") %>%
  janitor::adorn_pct_formatting(digits = 2) %>%
  janitor::adorn_ns() 
```

The table above shows both numbers--those who survived and those who didn't. In the next post we will dive deeper into some specific pilots and doctrines and how they influenced the number of aerial victories.

## Sign off

Thanks for reading! For more information email me at <mfrigaard@paradigmdata.io> to get in touch.

If you'd like the code that produced this blog, check out the [my GitHub repository](https://github.com/mjfrigaard/martinfrigaard-io-site).
